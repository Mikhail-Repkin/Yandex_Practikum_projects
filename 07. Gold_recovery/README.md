# Предсказание коэффициента восстановления золота из золотосодержащей руды

## Инструменты и библиотеки:
![Python](https://img.shields.io/badge/-Python-white?style=flat&logo=python)
![Pandas](https://img.shields.io/badge/-Pandas-white?style=flat&logo=pandas&logoColor=130754)
![seaborn](https://img.shields.io/badge/-seaborn-white?style=flat&logo=seaborn)
![matplotlib](https://img.shields.io/badge/-matplotlib-white?style=flat&logo=matplotlib)
![NumPy](https://img.shields.io/badge/-NumPy-white?style=flat&logo=NumPy&logoColor=3366C5)
![scikit-learn](https://img.shields.io/badge/-scikit-white?style=flat&logo=scikit-learn)
## Описание проекта:
Компания «Цифры» разрабатывает решения для эффективной работы промышленных предприятий.

**Цель** — компании нужно оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

**Задача исследования** — подготовить прототип модели машинного обучения, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды.

**Дополнительная информация:**  
* 	Процесс восстановления золота из золотосодержащей руды состоит из двух этапов: 
 * 1) Флотация — в установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов. На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости);
 * 2) Очистка — черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.
* Нужно спрогнозировать сразу две величины: 1) эффективность обогащения чернового концентрата `rougher.output.recovery` и 2) эффективность обогащения финального концентрата `final.output.recovery`.
* Для решения задачи используются метрики качества — sMAPE («симметричное среднее абсолютное процентное отклонение») и Итоговое sMAPE, складываемая из двух величин.
### Описание данных:
*Технологический процесс:*    
* Rougher feed — исходное сырье;    
* Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant;    
o	Xanthate — ксантогенат (промотер, или активатор флотации);    
o	Sulphate — сульфат (на данном производстве сульфид натрия);    
o	Depressant — депрессант (силикат натрия).    
* Rougher process (англ. «грубый процесс») — флотация;    
* Rougher tails — отвальные хвосты;    
* Float banks — флотационная установка;    
* Cleaner process — очистка;    
* Rougher Au — черновой концентрат золота;    
* Final Au — финальный концентрат золота.       

*Параметры этапов:*    
* air amount — объём воздуха;    
* fluid levels — уровень жидкости;    
* feed size — размер гранул сырья;    
* feed rate — скорость подачи.

*Наименование признаков:*    

Наименование признаков должно быть такое: `[этап].[тип_параметра].[название_параметра]`    
Пример: rougher.input.feed_ag    

Возможные значения для блока `[этап]`:        
* rougher — флотация;    
* primary_cleaner — первичная очистка;    
* secondary_cleaner — вторичная очистка;    
* final — финальные характеристики;    

Возможные значения для блока `[тип_параметра]`:    
* input — параметры сырья;
* output — параметры продукта;
* state — параметры, характеризующие текущее состояние этапа;
* calculation — расчётные характеристики.

## Выводы:
В ходе исследования были подготовлены и проанализированы данные. Было выявлено, что концентрации золота и свинца растут последовательно по этапам очистки, а концентрация серебра снижается. Распределения размеров гранул в тренировочной и тестовой выборках похожи, их средние и отклонения отличаются незначительно. Концентрация всех металлов (Au, Ag, Pb) также увеличивается от этапа очистки к этапу.

На этапе обучения и тестирования модели была подобрана наилучшая модель — модель случайного леса с показателем Итогового sMAPE 7.7, что лучше константной модели с показателем  8.74. На тестовых данных sMAPE лучшей модели составила 7.2, что еще лучше показателей обучающей выборки.

*Параметры лучшей модели для эффективности обогащения чернового концентрата: {'max_depth': 4, 'n_estimators': 10}    
Параметры лучшей модели для эффективность обогащения финального концентрата: {'max_depth': 4, 'n_estimators': 50}*

**Таким образом, был подготовлен прототип модели машинного обучения, которая предсказывает коэффициент восстановления золота из золотосодержащей руды с необходимой точностью.**
